<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kubb Tracker v1.06</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Kubb Tracker <span class="muted">v1.06</span></h1>
    <p>Aktuální uživatel: <strong id="current-user-name">žádný</strong></p>
  </header>

  <!-- Uživatelská sekce -->
  <section>
    <h2>Uživatelé</h2>
    <input id="user-name-input" type="text" placeholder="Jméno uživatele">
    <button id="add-user-btn">Přidat</button>
    <div id="user-list"></div>
  </section>

  <!-- Přepínání režimu -->
  <section>
    <h2>Režim</h2>
    <label><input type="radio" id="mode-8m-radio" name="mode" checked> 8m</label>
    <label><input type="radio" id="mode-82-radio" name="mode"> 8+2</label>
  </section>

  <!-- 8m režim -->
  <section id="mode-8m">
    <h2>8m trénink</h2>
    <div>
      <label>Počet hodů v sérii:
        <input type="number" id="throws-input" min="1" max="6" value="6">
      </label>
    </div>
    <div id="hit-buttons">
      <button class="hit-btn" data-value="0">0</button>
      <button class="hit-btn" data-value="1">1</button>
      <button class="hit-btn" data-value="2">2</button>
      <button class="hit-btn" data-value="3">3</button>
      <button class="hit-btn" data-value="4">4</button>
      <button class="hit-btn" data-value="5">5</button>
      <button class="hit-btn" data-value="6">6</button>
    </div>

    <!-- Souhrn -->
    <div id="current-training-summary" style="display:none;">
      <p>Sérií: <span id="series-count">0</span></p>
      <p>Shozeno: <span id="total-hit">0</span></p>
      <p>Hodů: <span id="total-throws">0</span></p>
      <p>Úspěšnost: <span id="success-rate">0</span>%</p>
    </div>

    <!-- NOVÉ: průběh -->
    <div id="current-training-progress" style="display:none;" aria-live="polite">
      <div class="progress-header">
        <strong>Průběh (série 8m):</strong>
        <span id="progress-info" class="muted"></span>
      </div>
      <div id="progress-list" class="progress-list"></div>
    </div>

    <button id="undo-last-series-btn">Vrátit poslední sérii</button>
    <button id="end-training-btn">Ukončit trénink</button>
  </section>

  <!-- 8+2 režim -->
  <section id="mode-82" style="display:none;">
    <h2>8+2 trénink</h2>
    <label><input type="radio" id="m82-classic-radio" name="m82mode" checked> Classic</label>
    <label><input type="radio" id="m82-unlimited-radio" name="m82mode"> Unlimited</label>

    <!-- Classic -->
    <div id="m82-classic">
      <h3>Classic</h3>
      <input type="number" id="m82-classic-throws" min="1" max="6" value="6">
      <div>
        <button class="m82c-chip" data-kubb="0">0</button>
        <button class="m82c-chip" data-kubb="5">5</button>
        <button class="m82c-chip" data-kubb="8">8</button>
        <button class="m82c-chip" data-kubb="9">9</button>
        <button class="m82c-chip" data-kubb="10">10</button>
      </div>
    </div>

    <!-- Unlimited -->
    <div id="m82-unlimited" style="display:none;">
      <h3>Unlimited</h3>
      <label>
        Zavřeno na <select id="m82-unl-pins"></select> kolících
      </label>
      <button id="m82-unl-save">Uložit</button>
      <button id="m82-unl-dnf">DNF</button>
    </div>
  </section>

  <!-- Historie -->
  <section>
    <h2>Historie</h2>
    <p id="history-preview">Vyber uživatele, abys viděl poslední záznam.</p>
    <button id="open-history-btn">Otevřít celou historii</button>
  </section>

  <!-- Statistiky -->
  <section>
    <h2>Statistiky</h2>
    <div>
      <button class="seg-btn active" data-range="7d">7 dní</button>
      <button class="seg-btn" data-range="30d">30 dní</button>
      <button class="seg-btn" data-range="all">Celkem</button>
    </div>
    <p id="stats-note"></p>
    <div id="stats"></div>
  </section>

  <!-- Import / Export -->
  <section>
    <h2>Export / Import</h2>
    <button id="export-all-btn">Exportovat všechny</button>
    <button id="export-current-btn">Exportovat aktuálního</button>
    <button id="import-btn">Importovat JSON</button>
    <input id="import-file" type="file" accept="application/json" style="display:none;">
  </section>

  <!-- Modal historie -->
  <div id="history-modal" class="modal" aria-hidden="true" data-dismiss="history-modal">
    <div class="modal-dialog">
      <div class="modal-header">
        <h3>Historie – <span id="history-modal-user"></span></h3>
        <button data-dismiss="history-modal">×</button>
      </div>
      <div class="modal-controls">
        <select id="history-page-size">
          <option value="30" selected>30</option>
          <option value="50">50</option>
          <option value="100">100</option>
          <option value="all">Vše</option>
        </select>
        <div>
          <button class="chip active" data-f="all">Vše</button>
          <button class="chip" data-f="8m">8m</button>
          <button class="chip" data-f="8p2Classic">8+2 Classic</button>
          <button class="chip" data-f="8p2Unlimited">8+2 Unlimited</button>
        </div>
      </div>
      <div id="history-list" class="modal-body"></div>
      <div class="modal-footer">
        <span id="history-info"></span>
        <button id="history-load-more">Načíst další</button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div id="toast-container" aria-live="polite"></div>
    <small id="cache-version" style="opacity:.6;"></small>
  </footer>

  <script src="script.js"></script>
</body>
</html>
